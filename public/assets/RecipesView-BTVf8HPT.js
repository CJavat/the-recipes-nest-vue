import{d as q,u as j,e as i,n as A,y as B,z as F,c as r,a as x,b as p,F as S,s as V,j as k,h as C,l as M,m as $,o as e,_ as N}from"./index-C2R5qiPR.js";import{u as E}from"./recipe.store-BAoCLKIH.js";import{A as L}from"./AddRecipe-B2lM7PJ4.js";import{_ as U}from"./Pagination.vue_vue_type_script_setup_true_lang-C_0H0mMU.js";import{_ as z}from"./RecipeCard.vue_vue_type_script_setup_true_lang-qrcxbkKX.js";import"./sweetalert2.esm.all-BGf-Fe8G.js";const I={key:0},D={class:"w-full flex justify-center items-center p-0"},G={key:0,class:"px-5"},H={key:0,class:"grid gap-5 grid-cols-1 md:grid-cols-3 xl:grid-cols-4"},J={key:1,class:"border border-red-500 text-red-500 rounded-md text-center p-2"},K={key:1,class:"h-96 flex justify-center items-center"},O={key:1,class:"h-96 flex justify-center items-center"},se=q({__name:"RecipesView",setup(Q){const f=M(),c=$(),_=E(),b=j(),d=i(!1),o=i(),s=i(6),u=i(0),m=i(1),h=i(2);A(()=>{s.value=Number(c.query.limit??6),u.value=Number(c.query.offset??0),m.value=Math.floor(u.value/s.value)+1,g(s.value,(m.value-1)*s.value)});const g=async(y,t)=>{var n;d.value=!0,isNaN(t)&&(t=0);try{const[a,v]=await Promise.all([_.getRecipes(y,t),_.getFavorites()]),{recipes:R,totalPages:w}=a;o.value=R.map(l=>({...l,id:l.id,image:l.image,title:l.title,User:{firstName:l.User.firstName},isFavorite:v.some(P=>P.recipeId===l.id)})),h.value=w}catch(a){if(console.log(a),o.value=[],a instanceof B&&((n=a.response)==null?void 0:n.data.statusCode)===401)return b.logout(),f.replace({path:"/auth/login"});f.push({path:"/dashboard"})}finally{d.value=!1}};return F(()=>c.query,()=>{s.value=Number(c.query.limit??4),u.value=Number(c.query.offset??0),g(s.value,u.value),m.value=Math.floor(u.value/s.value)+1}),(y,t)=>{var n;return d.value?(e(),r("div",O,[p(N,{class:"w-32 md:w-56"})])):(e(),r("div",I,[x("div",D,[p(L,{class:"my-5 cursor-pointer"})]),d.value?(e(),r("div",K,[p(N,{class:"w-32"})])):(e(),r("div",G,[t[0]||(t[0]=x("h3",{class:"text-2xl text-black dark:text-white mb-3"},"Recetas",-1)),o.value&&o.value.length>0?(e(),r("div",H,[(e(!0),r(S,null,V(o.value,(a,v)=>(e(),k(z,{key:v,recipe:a},null,8,["recipe"]))),128))])):(e(),r("p",J," No hay recetas para mostrar "))])),((n=o.value)==null?void 0:n.length)??!1?(e(),k(U,{key:2,class:"mt-16",limit:s.value,currentPage:m.value,finalPage:h.value,route:"/dashboard/recipes"},null,8,["limit","currentPage","finalPage"])):C("",!0)]))}}});export{se as default};
