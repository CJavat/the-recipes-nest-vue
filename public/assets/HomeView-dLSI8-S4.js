import{d as j,u as A,e as l,n as B,y as F,z as L,c as s,a as p,F as R,s as w,b as y,j as x,h as $,l as E,m as M,r as U,o as e,i as z,k as D,t as H,_ as C}from"./index-C2R5qiPR.js";import{u as I}from"./recipe.store-BAoCLKIH.js";import{S as T}from"./sweetalert2.esm.all-BGf-Fe8G.js";import{_ as G}from"./RecipeCard.vue_vue_type_script_setup_true_lang-qrcxbkKX.js";import{A as J}from"./AddRecipe-B2lM7PJ4.js";import{_ as K}from"./Pagination.vue_vue_type_script_setup_true_lang-C_0H0mMU.js";const O={class:"pt-5 flex flex-col"},Q={key:0},W={class:"px-5 hidden md:block"},X={class:"text-xs grid grid-cols-5 xl:grid-cols-5 gap-3"},Y={class:"w-full flex justify-center items-center p-0"},Z={key:0,class:"px-5"},ee={key:0,class:"grid gap-5 grid-cols-1 md:grid-cols-3 xl:grid-cols-4"},te={key:1,class:"border border-red-500 text-red-500 rounded-md text-center p-2"},se={key:1,class:"h-96 flex justify-center items-center"},ae={key:1,class:"h-96 flex justify-center items-center"},de=j({__name:"HomeView",setup(oe){const k=E(),d=M(),_=I(),P=A(),i=l(!1),c=l(),h=l(),a=l(6),m=l(0),f=l(1),b=l(2);B(()=>{S(),a.value=Number(d.query.limit??6),m.value=Number(d.query.offset??0),f.value=Math.floor(m.value/a.value)+1,N(a.value,(f.value-1)*a.value)});const N=async(r,t)=>{var g;i.value=!0,isNaN(t)&&(t=0);try{const[o,n]=await Promise.all([_.getRecipes(r,t),_.getFavorites()]),{recipes:v,totalPages:q}=o;c.value=v.map(u=>({...u,id:u.id,image:u.image,title:u.title,User:{firstName:u.User.firstName},isFavorite:n.some(V=>V.recipeId===u.id)})),b.value=q}catch(o){if(console.log(o),c.value=[],o instanceof F&&((g=o.response)==null?void 0:g.data.statusCode)===401)return P.logout(),k.replace({path:"/auth/login"});k.push({path:"/dashboard"})}finally{i.value=!1}},S=async()=>{i.value=!0;try{const r=await _.getCategories();h.value=r}catch(r){console.log(r),h.value=[],T.fire("Error",r,"error")}finally{i.value=!1}};return L(()=>d.query,()=>{a.value=Number(d.query.limit??4),m.value=Number(d.query.offset??0),N(a.value,m.value),f.value=Math.floor(m.value/a.value)+1}),(r,t)=>{var o;const g=U("RouterLink");return e(),s("div",O,[i.value?(e(),s("div",ae,[y(C,{class:"w-52"})])):(e(),s("div",Q,[p("div",W,[t[0]||(t[0]=p("h3",{class:"text-2xl text-black dark:text-white mb-3"},"CategorÃ­as",-1)),p("div",X,[(e(!0),s(R,null,w(h.value,(n,v)=>(e(),x(g,{key:v,to:`/dashboard/category/${n.id}`,class:"bg-sky-200 hover:bg-sky-300 px-5 py-2 rounded-full text-center"},{default:z(()=>[D(H(n.name),1)]),_:2},1032,["to"]))),128))])]),p("div",Y,[y(J,{class:"my-5 cursor-pointer"})]),i.value?(e(),s("div",se,[y(C,{class:"w-32"})])):(e(),s("div",Z,[t[1]||(t[1]=p("h3",{class:"text-2xl text-black dark:text-white mb-3"},"Recetas",-1)),c.value&&c.value.length>0?(e(),s("div",ee,[(e(!0),s(R,null,w(c.value,(n,v)=>(e(),x(G,{key:v,recipe:n},null,8,["recipe"]))),128))])):(e(),s("p",te," No hay recetas para mostrar "))])),((o=c.value)==null?void 0:o.length)??!1?(e(),x(K,{key:2,class:"mt-16",limit:a.value,currentPage:f.value,finalPage:b.value,route:"/dashboard"},null,8,["limit","currentPage","finalPage"])):$("",!0)]))])}}});export{de as default};
