import{d as L,e as c,f as _,n as $,c as n,a as e,w as B,b as M,h as u,g as m,v as f,F as x,s as v,C as q,j as A,l as N,o as i,t as P,_ as T}from"./index-C2R5qiPR.js";import{u as O}from"./recipe.store-BAoCLKIH.js";import{_ as X}from"./AdvancedCropper.vue_vue_type_script_setup_true_lang-Cn5s0iY4.js";import{S as C}from"./sweetalert2.esm.all-BGf-Fe8G.js";const z={class:"pt-7"},G={class:"mt-6 border-t border-t-sky-300 dark:border-t-sky-900"},H={class:"px-4 py-6 grid sm:grid-cols-3 sm:gap-4 sm:px-0 items-center grid-cols-2"},J={class:"mt-1 text-sm leading-6 text-sky-950 dark:text-sky-300 sm:mt-0"},K={class:"px-4 py-6 sm:px-0"},Q=["src","alt"],W={key:0,class:"text-sm uppercase"},Y={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},Z={key:0,class:"text-red-500"},ee={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},te={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},se=["onUpdate:modelValue"],oe=["onClick"],ie={key:0,class:"text-red-500"},re={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},ne=["onUpdate:modelValue"],le=["onClick"],ae={key:0,class:"text-red-500"},de={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},ce=["value"],ue={key:0,class:"text-red-500"},pe={class:"px-4 py-6 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-0"},me=["disabled"],ge={key:1},ke=L({__name:"CreateRecipeView",setup(fe){const F=N(),k=O(),R="http://localhost:3000/api",y=c(null),g=c(!1),h=c(),p=c(),b=c(),s=_({title:"",description:"",ingredients:c([]),steps:c([]),category:""}),a=_({title:!1,ingredients:!1,steps:!1,category:!1});$(()=>{h.value=k.categories});const S=()=>{s.ingredients.push("")},V=l=>{s.ingredients.splice(l,1)},U=()=>{s.steps.push("")},D=l=>{s.steps.splice(l,1)},E=l=>{const t=`${R.replace("/api","")}/no-recipe-image.jpg`;if(l){b.value=l;const o=new FileReader;o.onload=r=>{var w;const d=(w=r.target)==null?void 0:w.result;typeof d=="string"?p.value=d:p.value=t},o.readAsDataURL(l)}},I=async()=>{g.value=!0;try{if(s.title==="")return a.title=!0;if(a.title=!1,s.category==="")return a.category=!0;if(a.category=!1,s.ingredients.length<=0)return a.ingredients=!0;if(a.ingredients=!1,s.steps.length<=0)return a.steps=!0;a.steps=!1;const l=s.ingredients,t=s.steps,o=new FormData;o.append("title",s.title),o.append("description",s.description??""),o.append("categoryId",s.category),l.forEach(d=>{o.append("ingredients[]",d)}),t.forEach(d=>{o.append("steps[]",d)}),b.value&&o.append("file",b.value);const r=await k.createRecipe(o);C.fire("Receta Creada","La receta ha sido creada correctamente","success").then(()=>{F.replace("/dashboard")})}catch(l){C.fire("Error",l,"error"),console.error(l)}finally{g.value=!1}},j=()=>{y.value&&y.value.openFileDialog()};return(l,t)=>(i(),n("div",z,[e("div",null,[t[11]||(t[11]=e("div",{class:"px-4 sm:px-0"},[e("h3",{class:"text-2xl text-black dark:text-white mb-3"},"Crear Receta")],-1)),e("div",G,[e("form",{class:"divide-y divide-sky-300 dark:divide-sky-900",onSubmit:B(I,["prevent"])},[e("div",H,[t[4]||(t[4]=e("dt",{class:"text-sm font-medium leading-6 text-black dark:text-white"},"Avatar",-1)),e("dd",J,[e("div",K,[M(X,{class:"w-full md:w-96 h-96",ref_key:"imageCropperRef",ref:y,onFileSelected:E},null,512),e("button",{onClick:j,type:"button",class:"h-36 w-36 md:h-56 md:w-56 relative flex items-center justify-center border rounded-full border-sky-950 dark:border-sky-500"},[e("div",null,[p.value?(i(),n("img",{key:0,src:p.value,alt:`${s.title}`,class:"h-36 w-36 md:h-56 md:w-56 rounded-full"},null,8,Q)):u("",!0),t[3]||(t[3]=e("span",{class:"absolute inset-0 flex items-center justify-center text-white font-semibold bg-black bg-opacity-50 rounded-full opacity-0 hover:opacity-100 transition-opacity duration-300"},"Cambiar Foto De Receta",-1))]),p.value?u("",!0):(i(),n("p",W,"MI FOTO"))])])])]),e("div",Y,[t[5]||(t[5]=e("dt",{class:"text-sm font-medium leading-6 text-black dark:text-white"},"Título",-1)),e("div",null,[m(e("input",{"onUpdate:modelValue":t[0]||(t[0]=o=>s.title=o),id:"title",name:"title",type:"text",class:"block w-full rounded-md border-0 pl-3 py-1.5 text-sky-950 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-sky-500 outline-none sm:text-sm sm:leading-6",required:""},null,512),[[f,s.title]]),a.title?(i(),n("span",Z," El título es inválido ")):u("",!0)])]),e("div",ee,[t[6]||(t[6]=e("dt",{class:"text-sm font-medium leading-6 text-black dark:text-white"},"Descripción",-1)),m(e("textarea",{"onUpdate:modelValue":t[1]||(t[1]=o=>s.description=o),id:"description",name:"description",class:"block w-full rounded-md border-0 pl-3 py-1.5 text-sky-950 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-sky-500 outline-none sm:text-sm sm:leading-6",cols:"50"},null,512),[[f,s.description]])]),e("div",te,[t[7]||(t[7]=e("dt",{class:"text-sm font-medium text-black dark:text-white"},"Ingredientes",-1)),e("ul",null,[(i(!0),n(x,null,v(s.ingredients,(o,r)=>(i(),n("li",{key:r,class:"flex justify-center items-center gap-2"},[m(e("input",{"onUpdate:modelValue":d=>s.ingredients[r]=d,required:"",placeholder:"Escribe un ingrediente",class:"my-2 block w-full rounded-md border-0 pl-3 py-1.5 text-sky-950 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-sky-500 outline-none sm:text-sm sm:leading-6"},null,8,se),[[f,s.ingredients[r]]]),e("button",{type:"button",class:"flex-1 w-20 uppercase h-fit rounded-md border border-red-600 hover:bg-red-500 text-red-500 hover:text-red-50 px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:d=>V(r)}," X ",8,oe)]))),128)),a.ingredients?(i(),n("span",ie," Los ingredientes son obligatorios ")):u("",!0)]),e("button",{type:"button",class:"uppercase mt-5 md:my-2 w-full h-fit rounded-md border border-sky-600 hover:bg-sky-500 text-sky-500 hover:text-sky-50 px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:S}," Agregar Ingrediente ")]),e("div",re,[t[8]||(t[8]=e("dt",{class:"text-sm font-medium leading-6 text-black dark:text-white"},"Pasos",-1)),e("ul",null,[(i(!0),n(x,null,v(s.steps,(o,r)=>(i(),n("li",{key:r,class:"flex justify-center items-center gap-2"},[m(e("input",{"onUpdate:modelValue":d=>s.steps[r]=d,required:"",placeholder:"Escribe un paso",class:"my-2 block w-full rounded-md border-0 pl-3 py-1.5 text-sky-950 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-sky-500 outline-none sm:text-sm sm:leading-6"},null,8,ne),[[f,s.steps[r]]]),e("button",{type:"button",class:"flex-1 w-20 uppercase h-fit rounded-md border border-red-600 hover:bg-red-500 text-red-500 hover:text-red-50 px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:d=>D(r)}," X ",8,le)]))),128)),a.steps?(i(),n("span",ae," Los pasos son obligatorios ")):u("",!0)]),e("button",{type:"button",class:"uppercase mt-5 md:my-2 w-full h-fit rounded-md border border-sky-600 hover:bg-sky-500 text-sky-500 hover:text-sky-50 px-3 py-1.5 text-sm font-semibold leading-6 shadow-sm focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2",onClick:U}," Agregar Paso ")]),e("div",de,[t[10]||(t[10]=e("dt",{class:"text-sm font-medium leading-6 text-black dark:text-white"},"Categoria",-1)),e("div",null,[m(e("select",{"onUpdate:modelValue":t[2]||(t[2]=o=>s.category=o),name:"category",id:"category",class:"block w-full rounded-md border-0 pl-3 py-1.5 text-sky-950 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-sky-500 outline-none sm:text-sm sm:leading-6",required:""},[t[9]||(t[9]=e("option",{value:""},"Seleccione una categoría",-1)),(i(!0),n(x,null,v(h.value,(o,r)=>(i(),n("option",{key:r,value:o.id},P(o.name),9,ce))),128))],512),[[q,s.category]]),a.category?(i(),n("span",ue," La categoría es obligatoria ")):u("",!0)])]),e("div",pe,[e("button",{disabled:g.value,type:"submit",class:"flex w-full justify-center rounded-md bg-sky-600 px-3 py-1.5 text-sm font-semibold leading-6 text-white shadow-sm hover:bg-sky-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[g.value?(i(),A(T,{key:0,class:"w-6"})):(i(),n("span",ge,"Crear Receta"))],8,me)])],32)])])]))}});export{ke as default};
